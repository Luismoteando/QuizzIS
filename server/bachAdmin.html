<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel de control</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="css/admin.css">
</head>
<body>
  <div class="container-fluid">
    <div class="row" style="padding: 10px;">
      <div class="col-md-12">
        <div class="page-header text-center">
          <h1>
            Panel de control
          </h1>
          <h3>
            Bachillerato
          </h3>
        </div>
        <div class="row text-center" style="padding: 10px;">
          <div class="col-md-4 col-sm-12">
            <div class="jumbotron m-1">
              <h3>
                Sonidos
              </h3>
              <div class="row marcador-container" style="padding: 10px;">
                <div class="col-md-2 col-sm-2" style="margin: auto;">

                  <button id="correct" type="button" class="btn">
                    <i class="fas fa-check-circle"></i>
                  </button>
                </div>
              </div>
              <div class="row marcador-container" style="padding: 10px;">
                <div class="col-md-2 col-sm-2" style="margin: auto;">

                  <button id="incorrect" type="button" class="btn">
                    <i class="fas fa-times-circle"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-8 col-sm-12">
            <div class="jumbotron m-1">
              <h3>
                Preguntas
              </h3>
              <div class="row controls">
                <button id="previous" type="button" class="btn">
                  <i class="fas fa-backward"></i><span> Anterior</span>
                </button>

                <button id="play" type="button" class="btn">
                  <i class="fas fa-pause"></i><span> Pausar</span>
                </button>

                <button id="next" type="button" class="btn">
                  <i class="fas fa-forward"></i><span> Siguiente</span>
                </button>
              </div>

              <div class="row timers">
                <button id="timer16" type="button" class="btn">
                  <i class="fas fa-stopwatch"></i><span> 16”</span>
                </button>
              </div>

              <div class="row types">
                <button id="oneInFour" type="button" class="btn">
                  <i class="fas fa-ellipsis-v"></i><span> Una entre cuatro</span>
                </button>

                <button id="oneInThree" type="button" class="btn">
                  <i class="fas fa-ellipsis-v"></i><span> Una entre tres</span>
                </button>
              </div>

              <div id="fourOptions">
                <div class="row options">
                  <button id="option1in4" type="button" class="btn">
                    Opción 1
                  </button>

                  <button id="option2in4" type="button" class="btn">
                    Opción 2
                  </button>
                </div>
                <div class="row options">
                  <button id="option3in4" type="button" class="btn">
                    Opción 3
                  </button>

                  <button id="option4in4" type="button" class="btn">
                    Opción 4
                  </button>
                </div>
              </div>

              <div id="threeOptions">
                <div class="row controls">
                  <button id="option1in3" type="button" class="btn">
                    Opción 1
                  </button>

                  <button id="option2in3" type="button" class="btn">
                    Opción 2
                  </button>

                  <button id="option3in3" type="button" class="btn">
                    Opción 3
                  </button>
                </div>
              </div>
            </div>
          </div>


          <div class="col-md-12 col-sm-12">
            <div class="jumbotron m-1">
              <h3>
                Marcadores
              </h3>
              <div class="row pushbuttons">
                <button id="lock" type="button" class="btn">
                  <i class="fas fa-lock-open"></i><span> Bloquear pulsadores</span>
                </button>
              </div>
              <div class="row">
                <div class="col-md-4 col-sm-12">
                  <h4>
                    Marcador A
                  </h4>
                  <div class="row marcador-container" style="padding: 10px;">
                    <div class="col-md-2 col-sm-2" style="margin: auto;">

                      <button id="addA" type="button" class="btn">
                        <i class="fas fa-plus"></i>
                      </button>
                    </div>
                  </div>
                  <div class="row marcador-container" style="padding: 10px;">
                    <div class="col-md-2 col-sm-2" style="margin: auto;">

                      <button id="substractA" type="button" class="btn">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="col-md-4 col-sm-12">
                  <h4>
                    Marcador B
                  </h4>
                  <div class="row marcador-container" style="padding: 10px;">
                    <div class="col-md-2 col-sm-2" style="margin: auto;">

                      <button id="addB" type="button" class="btn">
                        <i class="fas fa-plus"></i>
                      </button>
                    </div>
                  </div>
                  <div class="row marcador-container" style="padding: 10px;">
                    <div class="col-md-2 col-sm-2" style="margin: auto;">

                      <button id="substractB" type="button" class="btn">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="col-md-4 col-sm-12">
                  <h4>
                    Marcador C
                  </h4>
                  <div class="row marcador-container" style="padding: 10px;">
                    <div class="col-md-2 col-sm-2" style="margin: auto;">

                      <button id="addC" type="button" class="btn">
                        <i class="fas fa-plus"></i>
                      </button>
                    </div>
                  </div>
                  <div class="row marcador-container" style="padding: 10px;">
                    <div class="col-md-2 col-sm-2" style="margin: auto;">

                      <button id="substractC" type="button" class="btn">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<script>
var width;
var playing = "true";
var locked = "false";

$(document).ready(function () {
  runPoll();
  autoPause(7000);
});

function runPoll() {
  setTimeout(function () {
    $.ajax({
      url: 'http://olistreaming.ddns.net:8888/server/bachServer.php',
      success: function (response) {
        playing = response[0].value;
        locked = response[8].value;
      },
      dataType: "json",
      complete: function () {
        runPoll();
      }
    })
  }, 100);
};

function autoPause(timeout) {
  width = $(window).width();

  setTimeout(function() {
    $.post("bachServer.php", { play: false });
    if(width < 575.98) {
      play.innerHTML = '<i class="fas fa-play"></i>';
    } else {
      play.innerHTML = '<i class="fas fa-play"></i><span> Reproducir</span>';
    }
  }, timeout);
}

play.onclick = function() {
  width = $(window).width();

  if(width < 575.98) {
    if(playing == "false") {
      $.post("bachServer.php", { play: true });
      play.innerHTML = '<i class="fas fa-pause"></i>';
    } else {
      $.post("bachServer.php", { play: false });
      play.innerHTML = '<i class="fas fa-play"></i>';
    }
  } else {
    if(playing == "false") {
      $.post("bachServer.php", { play: true });
      play.innerHTML = '<i class="fas fa-pause"></i><span> Pausar</span>';
    } else {
      $.post("bachServer.php", { play: false });
      play.innerHTML = '<i class="fas fa-play"></i><span> Reproducir</span>';
    }
  }
  autoPause(29000);
};

previous.onclick = function() {
  width = $(window).width();

  $.post("bachServer.php", { previous: true, play: true});
  if(width < 575.98) {
    play.innerHTML = '<i class="fas fa-pause"></i>';
  } else {
    play.innerHTML = '<i class="fas fa-pause"></i><span> Pausar</span>';
  }
  autoPause(7000);
};

next.onclick = function() {
  width = $(window).width();

  $.post("bachServer.php", { next: true, play: true });
  if(width < 575.98) {
    play.innerHTML = '<i class="fas fa-pause"></i>';
  } else {
    play.innerHTML = '<i class="fas fa-pause"></i><span> Pausar</span>';
  }
  autoPause(7000);
};

function timeout() {
  if(time >= 0) {
    time -= 1;
    $.post("bachServer.php", { timer: time });
    setTimeout("timeout()", 1000);
  } else {
    time = 6;
    counterattack();
  }
}

function counterattack() {
  if(time >= 0) {
    time -= 1;
    $.post("bachServer.php", { timer: time });
    setTimeout("counterattack()", 1000);
  } else {
    return
  }
}

timer16.onclick = function() {
  time = 17;
  timeout();
}

oneInFour.onclick = function() {
  if (fourOptions.style.display == "none") {
    threeOptions.style.display = "none";
    fourOptions.style.display = "block";
  } else {
    threeOptions.style.display = "none";
    fourOptions.style.display = "none";
  }
}

oneInThree.onclick = function() {
  if (threeOptions.style.display == "none") {
    fourOptions.style.display = "none";
    threeOptions.style.display = "block";
  } else {
    fourOptions.style.display = "none";
    threeOptions.style.display = "none";
  }
}

option1in4.onclick = function() {
  $.post("bachServer.php", { option1in4: true });
};

option2in4.onclick = function() {
  $.post("bachServer.php", { option2in4: true });
};

option3in4.onclick = function() {
  $.post("bachServer.php", { option3in4: true });
};

option4in4.onclick = function() {
  $.post("bachServer.php", { option4in4: true });
};

option1in3.onclick = function() {
  $.post("bachServer.php", { option1in3: true });
};

option2in3.onclick = function() {
  $.post("bachServer.php", { option2in3: true });
};

option3in3.onclick = function() {
  $.post("bachServer.php", { option3in3: true });
};

correct.onclick = function() {
  $.post("bachServer.php", { sfx: 0 });
};

incorrect.onclick = function() {
  $.post("bachServer.php", { sfx: 1 });
};

lock.onclick = function() {
  if(locked == "false") {
    $.post("bachServer.php", { lock: "true" });
    lock.innerHTML = '<i class="fas fa-lock"></i><span> Desloquear pulsadores</span>';
  } else {
    $.post("bachServer.php", { lock: "false" });
    lock.innerHTML = '<i class="fas fa-lock-open"></i><span> Bloquear pulsadores</span>';
  }
}

addA.onclick = function() {
  $.post("bachServer.php", { addA: true });
};

substractA.onclick = function() {
  $.post("bachServer.php", { substractA: true });
};

addB.onclick = function() {
  $.post("bachServer.php", { addB: true });
};

substractB.onclick = function() {
  $.post("bachServer.php", { substractB: true });
};

addC.onclick = function() {
  $.post("bachServer.php", { addC: true });
};

substractC.onclick = function() {
  $.post("bachServer.php", { substractC: true });
};
</script>
</body>
</html>
